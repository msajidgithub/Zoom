<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
   <style>
     .main {
          height: 100vh;
          display: flex;
      }

      .main__left {
          flex: 1;
          display: flex;
          flex-direction: column;
      }

      .main__right {
          flex: 0.2
      }

      .main__videos {
          flex-grow: 1;
          background-color: black;
          display: flex;
          justify-content: center;
          align-items: center;
          padding: 40px;
      }

      .main__controls {
          background-color: #1C1E20;
      }

      .main__right {
          background-color: #242324;
          border-left: 1px solid #3D3D42;
      }

      .main__controls {
          color: #D2D2D2;
          display: flex;
          justify-content: space-between;
          padding: 5px;
      }

      .main__controls__block {
          display: flex;
      }

      .main__controls__button {
          display: flex;
          flex-direction: column;
          justify-content: center;
          align-items: center;
          padding: 8px 10px;
          min-width: 80px;
          cursor: pointer;
      }

      .main__controls__button:hover {
          background-color: #343434;
          border-radius: 5px;
      }

      .main__controls__button i {
          font-size: 24px;
      }

      .main__right {
          display: flex;
          flex-direction: column;
      }

      .main__header {
          padding-top: 5px;
          color: #F5F5F5;
          text-align: center;
      }

      .main__chat_window {
          flex-grow: 1;
          overflow-y: auto;
      }

      .messages{
          color: white;
          list-style: none;
      }

      .main__message_container {
          padding: 22px 12px;
          display: flex;
      }

      .main__message_container input {
          flex-grow: 1;
          background-color: transparent;
          border: none;
          color: #F5F5F5;
      }

      .leave_meeting {
          color: #EB534B;
      }

      .unmute, .stop {
          color: #CC3B33;
      }


   </style>
  <script src="https://kit.fontawesome.com/c939d0e917.js"></script>
  <script>
    const ROOM_ID = "<%= roomId %>"


  </script>
  <!-- Include from the CDN -->
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.0.0-rc.5/dist/html2canvas.min.js"></script>
  <script defer src="https://unpkg.com/peerjs@1.2.0/dist/peerjs.min.js"></script>
  <script src="/socket.io/socket.io.js" defer></script>
  <script src="script.js" defer></script>
  <title>Document</title>
  <style>
    
    video {
      object-fit: cover;
    }

    #img-id{
      width: auto;
      height: auto;
    }


  </style>
</head>
<body>
  <div class="main">
    <div class="main__left">
      <div id="video-grid" class="main__videos"></div>
  <div class="main__controls">
    <div class="main__controls__block">
       <div onclick="muteUnmute()" class="main__controls__button main__mute_button">
          <i class="fas fa-microphone" aria-hidden="true"></i>
          <span>Mute</span>
       </div>
       <div onclick="playStop()" class="main__controls__button main__video_button">
          <i class="fas fa-video" aria-hidden="true"></i>
          <span>Stop Video</span>
       </div>
    </div>
    <div class="main__controls__block">
       <div onclick="shoot()" class="main__controls__button">
          <i class="fas fa-user-friends" aria-hidden="true"></i>
          <span>Participants</span>
       </div>
    </div>
    <div class="main__controls__block">
      
    </div>
 </div>

    </div>
  </div>
  <div id="img-grid"></div>
    <!-- Define the button 
    that will be used to 
    take the screenshot -->
    <!-- <div class="output"></div> -->
    <canvas id="canvas" style="display: none;"></canvas>

    <!-- <button id="snap" onclick="shoot()">Take screenshot</button> -->

  </body>

		<script type="text/javascript">

    var scaleFactor = 0.25;

   


    

    function capture(video, scaleFactor) {
        if (scaleFactor == null) {
            scaleFactor = 1;
        }
        var w = video.videoWidth * scaleFactor;
        var h = video.videoHeight * scaleFactor;
        var canvas = document.getElementById("canvas");
        var ctx = canvas.getContext('2d');
        ctx.drawImage(video, 0, 0, w, h);
    }

    function shoot() {
        var video = document.getElementsByTagName('video')[0];
        var output = document.getElementById('img-grid');


        capture(video, scaleFactor);
        convertCanvasToImage();
    }


  		function snap() {
        let canvas = document.getElementById('canvas');
        let ctx = canvas.getContext('2d');
        ctx.drawImage(video, 0, 0 ,100, 100);
      }

      function convertCanvasToImage() {
        
        let canvas = document.getElementById("canvas");
        let image = new Image(600,900);
        image.width = 1000;
        image.height = 1000;
        image.src = canvas.toDataURL();
        image.id = "img-id";
        if(document.getElementById("img-id") != null){
          document.getElementById("img-id").remove();
        }
      document.getElementById("img-grid").appendChild(image);
      }
      
	</script>

</html>